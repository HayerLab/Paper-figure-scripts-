%the order for these is [ siNT cntrl, siSLKLOKcntrl, siNT Noc, siSLKLOKnoc]; 

conditions ={'siNT cntrl', 'siSLKLOK cntrl', 'siNT noc', 'siSLKLOK noc'}'; 
trial_1_seph = [0.14 0.12 0.71 0.5]; 
tria1_2_nada= [0.04  0.06 0.3924 0.2216]; 
trial_3_seph = [0.23 0.23 0.63 0.55] ; 
trial_4_seph = [0.10 0.08 0.42 0.26]; 
trial_5_arnold = [0.074 0.066 0.51 0.37]; 

x = [1 2 3 4];

f = figure; 
xlim([0 5])
ylim([0 1]); 
xticks([0:1:5]); 
xticklabels({'','siNT ctl', 'siSL ctl', 'siNT Noc' , 'siSL Noc', ''}); 
hold on; 
ylabel('fraction cells blebbing'); 

plot(x, trial_1_seph, '*-', 'LineWidth', 3); 

plot(x,tria1_2_nada, '*-',  'LineWidth', 3); 
plot(x, trial_3_seph, '*-',  'LineWidth', 3); 
plot(x, trial_4_seph, '*-',  'LineWidth', 3); 
plot(x, trial_5_arnold, '*-',  'LineWidth', 3); 

legend('T1', 'T2', 'T3', 'T4', 'T5'); 

save('C:\Users\marsh\OneDrive - McGill University\research paper\results good_Feb2023\Version231221_SciAdv_submitted\Revision\blebbing siRNA trials\meanvalues.mat','conditions', 'trial_1_seph', 'tria1_2_nada', 'trial_3_seph', 'trial_4_seph', 'trial_5_arnold'); 

%% repeated measures ANOVA 
clc; 
clear; 
trial_1_seph = [0.14 0.12 0.71 0.5]; 
tria1_2_nada= [0.04  0.06 0.3924 0.2216]; 
trial_3_seph = [0.23 0.23 0.63 0.55] ; 
trial_4_seph = [0.10 0.08 0.42 0.26]; 

trials ={'Trial 1', 'Trial 2', 'Trial 3', 'Trial 4'}'; 

measures =zeros(4,4); 
measures(1, :) = trial_1_seph; 
measures(2, :) = tria1_2_nada; 
measures(3, :) = trial_3_seph; 
measures(4, :) = trial_4_seph; 

% t = table(trials,measures(:,1),measures(:,2),measures(:,3),measures(:,4),...
% 'VariableNames',{'Trial','siNTcntrl','siSLKLOKcntrl','siNTnoc','siSLKLOKnoc'});
% 
% Meas = table([1 2 3 4]','VariableNames',{'Measurements'});
% 
% 
% rm = fitrm(t,'siNTcntrl-siSLKLOKnoc ~ Trial','WithinDesign',Meas);
% 
% ranovatbl = ranova(rm); 


[p,tbl,stats]=anova1(measures); 
multcompare(stats); 


%% 

siNT = [0
0.333333333
0.416666667
0.5
0.363636364
0.4
0.285714286
0.066666667
0
0.571428571
0
0.523809524
0.285714286
0.25
0
0.125
0.416666667
0
0.5
0.6
0.153846154
0.75
0.5
0.428571429
0.235294118
0.5
0.625
0.5
0.357142857
0
0.2
0.428571429
0.857142857
0.428571429
0.428571429
0.5
0.583333333
0.5
0
0.25
0.25
0.666666667
0.2
0.375
0.222222222
0.181818182
0.25
0.555555556
0.625
0.285714286
0
0.75
0.666666667
0.733333333
0.875
0.333333333
0.5
0.75
0.411764706
0.2
0.666666667
0.333333333
0
0.583333333
0.7
0.875
0.8
0.333333333
0.416666667
0.8
0.409090909
0.909090909
0.454545455
0.6
0.5
0.375
0.833333333
0.666666667
0.8
0.625
0.428571429
0.727272727
1
0.5
0.428571429
0.9
1
0.4
0.333333333
0.909090909
0.916666667
0.6
0.666666667
0.4
0.444444444
0.818181818
0.583333333
1
0.846153846
0.8
0.6
0.714285714
0.857142857
0.818181818
0.8
0.9
0.545454545
0.6
0.416666667
0.857142857
0.625
0.5
0.4
0.923076923
0.8
0
0.4
0.75
1
0.75
1
0.923076923
0.9
0.6
0.636363636
0.4
0.857142857
0.684210526

0.6
0.818181818
0.722222222
0.5
0.5
0.578947368
0.75
0.4
0.666666667
0.666666667
0.4
0.631578947
0.666666667
0.733333333
0.6
0.75
0.7
0.714285714
0.9
0.380952381
0.5
0.4
0.666666667
0.5625
0.846153846
0.923076923
0.740740741
0.571428571
0.8
0.75
0.714285714]; 

siSLKLOK = [0.333333333
0.285714286
0.4
0.111111111
0.333333333
0.333333333
0.25
0.071428571
0
0.4
0
0
0.4
0
0
0
0
1
0.5
1
0
0
0.333333333
0
0.166666667
0.333333333
0.111111111
0.285714286
0.25
0.5
0.2
0
0.444444444
0.166666667
0
0.666666667
0
0
0
0
0.6
0.166666667
0.2
0.75
0.15
0.6
0.142857143
0.333333333
0.125
0.166666667
1
0.75
0.153846154
0.294117647
1
0.285714286
0
0.153846154
0.333333333
0.125
0.333333333
0.25
0
0.333333333
0.272727273
0.142857143
0.666666667
0.333333333
0.277777778
0.785714286
0.666666667
0.25
0.375
0.5
0.375
0.260869565
0.380952381
0.7
0.444444444
0.25
0.75
0.2
0.444444444
0.444444444
0.615384615
0.833333333
0.6
0.5
0.727272727
0.666666667
0.307692308
0.266666667
0.363636364
0
0.384615385
0.428571429
0.826086957
1
0.333333333
0.25
1
0.75
0.8
0.636363636
0.8
0.7
0.333333333
0.285714286
0.466666667
0.666666667
0.333333333
0.166666667
0.75
0.727272727
0.526315789
0.457142857
0.375
0.333333333
1
0.428571429
1
0.833333333
1
0
0.388888889
0.6
0.8
1
0.461538462
0.5
0.571428571
0.5
0.363636364
0.333333333
0.25
0.6
0.625
0.666666667
0.777777778
0.333333333
0.75
0.909090909
0.555555556
0.5
0.428571429
0.4
0.642857143
0.485714286
0.571428571
0.8
0.5
0.5
0.375
0.888888889
0.571428571
0.8
0.444444444
0.636363636
1
0.545454545
0.266666667
0.571428571
0.608695652
0.5
0.666666667
0.307692308
0.875
0
0.666666667
0.333333333
1
0.5
0.111111111
0.7
0.9
]; 

s.NT = siNT; 
s.SLKLOK =siSLKLOK; 

violinplot(s); 

[p, h] = ranksum(siNT, siSLKLOK)
legend('Seph T1', 'Nada T2', 'Seph T3'); 

